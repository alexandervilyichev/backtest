# –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è V2 —Å—Ç—Ä–∞—Ç–µ–≥–∏–π –≤ —Å–∏—Å—Ç–µ–º—É –±—ç–∫—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

## –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

### 1. –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è Runner –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ V2 —Å—Ç—Ä–∞—Ç–µ–≥–∏–π

**–§–∞–π–ª**: `internal/app/backtester/runner.go`

#### –ò–∑–º–µ–Ω–µ–Ω–∏—è:

1. **–î–æ–±–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ `runStrategyV2`** - —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è V2 —Å—Ç—Ä–∞—Ç–µ–≥–∏–π
2. **–ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω `runSingleStrategy`** - —Ç–µ–ø–µ—Ä—å –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –æ–±–∞ —Ä–µ–µ—Å—Ç—Ä–∞ (V1 –∏ V2)
3. **–û–±–Ω–æ–≤–ª–µ–Ω `RunAllStrategies`** - –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –∏–∑ –æ–±–æ–∏—Ö —Ä–µ–µ—Å—Ç—Ä–æ–≤
4. **–î–æ–±–∞–≤–ª–µ–Ω–∞ –æ–±–µ—Ä—Ç–∫–∞ `strategyConfigV2Wrapper`** - –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ V2 –∫–æ–Ω—Ñ–∏–≥–æ–≤ —Å V1 –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º

#### –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:

```go
// –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±–æ–∏—Ö —Ä–µ–µ—Å—Ç—Ä–æ–≤
func (r *BaseStrategyRunner) runSingleStrategy(strategyName string, candles []internal.Candle) (*BenchmarkResult, internal.StrategyConfig, error) {
	// –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–±—É–µ–º V2 —Å—Ç—Ä–∞—Ç–µ–≥–∏—é
	if strategyV2, ok := internal.GetStrategyV2(strategyName); ok {
		return r.runStrategyV2(strategyName, strategyV2, candles)
	}
	
	// –ï—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ V2, –∏—Å–ø–æ–ª—å–∑—É–µ–º V1
	strategy := internal.GetStrategy(strategyName)
	// ...
}

// –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–π –∏–∑ –æ–±–æ–∏—Ö —Ä–µ–µ—Å—Ç—Ä–æ–≤
func (r *ParallelStrategyRunner) RunAllStrategies(candles []internal.Candle) ([]BenchmarkResult, error) {
	strategyNamesV1 := internal.GetStrategyNames()
	strategyNamesV2 := internal.GetStrategyNamesV2()
	strategyNames := append(strategyNamesV1, strategyNamesV2...)
	// ...
}
```

### 2. –ü—Ä–∏–º–µ—Ä —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ V2

**–§–∞–π–ª**: `strategies/trend/golden_cross_strategy_v2.go`

–ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—á–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è Golden Cross —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –Ω–∞ –Ω–æ–≤–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ:
- ‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π
- ‚úÖ –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å–∏–≥–Ω–∞–ª–æ–≤
- ‚úÖ –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ `init()`

### 3. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

**–§–∞–π–ª—ã**:
- `docs/V2_STRATEGY_GUIDE.md` - –ø–æ–¥—Ä–æ–±–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Å–æ–∑–¥–∞–Ω–∏—é V2 —Å—Ç—Ä–∞—Ç–µ–≥–∏–π
- `README.md` - –æ–±–Ω–æ–≤–ª–µ–Ω —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ V2 –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ
- `V2_INTEGRATION_SUMMARY.md` - —ç—Ç–æ—Ç —Ñ–∞–π–ª

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –¢–µ—Å—Ç –Ω–∞ –º–∞–ª–æ–º –¥–∞—Ç–∞—Å–µ—Ç–µ (49 —Å–≤–µ—á–µ–π)

```bash
./backtester --file tgld_small.json
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**:
- ‚úÖ –ù–∞–π–¥–µ–Ω–æ 27 —Å—Ç—Ä–∞—Ç–µ–≥–∏–π V1 –∏ 1 —Å—Ç—Ä–∞—Ç–µ–≥–∏—è V2
- ‚úÖ `golden_cross_v2` —É—Å–ø–µ—à–Ω–æ –∑–∞–ø—É—â–µ–Ω–∞
- ‚úÖ –í—Å–µ–≥–æ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ 28 —Å—Ç—Ä–∞—Ç–µ–≥–∏–π

### –¢–µ—Å—Ç –Ω–∞ –±–æ–ª—å—à–æ–º –¥–∞—Ç–∞—Å–µ—Ç–µ (1076 —Å–≤–µ—á–µ–π)

```bash
./backtester --file tgld.json
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**:
- ‚úÖ `golden_cross_v2`: +13.47% –ø—Ä–∏–±—ã–ª–∏, 1 —Å–¥–µ–ª–∫–∞
- ‚úÖ `golden_cross` (V1): +13.47% –ø—Ä–∏–±—ã–ª–∏, 1 —Å–¥–µ–ª–∫–∞
- ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏–¥–µ–Ω—Ç–∏—á–Ω—ã, —á—Ç–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –¢–µ—Å—Ç —Å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–º —Ñ–∞–π–ª–æ–º

```bash
./backtester --file tgld.json --config optimized_configs.json --strategy golden_cross_v2
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**:
- ‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∏–∑ —Ñ–∞–π–ª–∞
- ‚úÖ –°—Ç—Ä–∞—Ç–µ–≥–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –ø—Ä–µ–¥–∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
- ‚úÖ JSON —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

## –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

### –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

- ‚úÖ –í—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ V1 —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç —Ä–∞–±–æ—Ç–∞—Ç—å
- ‚úÖ –°—Ç–∞—Ä—ã–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã —Å–æ–≤–º–µ—Å—Ç–∏–º—ã
- ‚úÖ –ù–µ—Ç breaking changes –≤ API

### –ü—Ä—è–º–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

- ‚úÖ V2 —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–∫–ª—é—á–∞—é—Ç—Å—è –≤ –æ–±—â–∏–π —Ç–µ—Å—Ç
- ‚úÖ V2 —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç —Å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–º–∏ —Ñ–∞–π–ª–∞–º–∏
- ‚úÖ V2 —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

## –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π (V1 + V2)

```bash
./backtester --file candles.json --strategy all
```

### –ó–∞–ø—É—Å–∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π V2 —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏

```bash
./backtester --file candles.json --strategy golden_cross_v2
```

### –ó–∞–ø—É—Å–∫ —Å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π

```bash
./backtester --file candles.json --config optimized_configs.json --strategy all
```

### Debug —Ä–µ–∂–∏–º

```bash
./backtester --file candles.json --debug
```

–í—ã–≤–æ–¥ –ø–æ–∫–∞–∂–µ—Ç:
```
üêõ DEBUG: –ù–∞–π–¥–µ–Ω–æ 27 —Å—Ç—Ä–∞—Ç–µ–≥–∏–π V1 –∏ 1 —Å—Ç—Ä–∞—Ç–µ–≥–∏–π V2 –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
üêõ DEBUG: V1: extrema_strategy, ma_channel, ...
üêõ DEBUG: V2: golden_cross_v2
üêõ DEBUG: –ó–∞–ø—É—Å–∫ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ V2 golden_cross_v2
```

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ V2 –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

1. **–ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞**: `GridSearchOptimizer` —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –≤—Å–µ—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π
2. **–¢–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å**: –ö–∞–∂–¥—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –º–æ–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω–æ
3. **–ì–∏–±–∫–æ—Å—Ç—å**: –õ–µ–≥–∫–æ –∑–∞–º–µ–Ω–∏—Ç—å –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä –∏–ª–∏ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å–∏–≥–Ω–∞–ª–æ–≤
4. **–ß–∏—Ç–∞–µ–º–æ—Å—Ç—å**: –Ø–≤–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —á–µ—Ä–µ–∑ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä—ã
5. **–†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å**: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### –ú–∏–≥—Ä–∞—Ü–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π

–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –º–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –Ω–∞ V2 –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É:

1. –í—ã–±–µ—Ä–∏—Ç–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–∏
2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π —Ñ–∞–π–ª `*_v2.go`
3. –†–µ–∞–ª–∏–∑—É–π—Ç–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã V2 (—Å–º. `docs/V2_STRATEGY_GUIDE.md`)
4. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ, —á—Ç–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏–¥–µ–Ω—Ç–∏—á–Ω—ã V1 –≤–µ—Ä—Å–∏–∏
5. –ü–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –º–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å V1 –≤–µ—Ä—Å–∏—é

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä–æ–≤

V2 –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:

- –ì–µ–Ω–µ—Ç–∏—á–µ—Å–∫–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã
- –ë–∞–π–µ—Å–æ–≤—Å–∫–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è
- Particle Swarm Optimization
- Simulated Annealing

–ü—Ä–∏–º–µ—Ä:
```go
geneticOptimizer := NewGeneticOptimizer(slippageProvider, configGenerator.Generate)
strategy := internal.NewStrategyBase(
	"my_strategy_genetic",
	signalGenerator,
	configManager,
	geneticOptimizer,  // <-- –Ω–æ–≤—ã–π –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä!
	slippageProvider,
)
```

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è V2 –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∞. –°–∏—Å—Ç–µ–º–∞ —Ç–µ–ø–µ—Ä—å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –æ–±–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç:

- ‚úÖ –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –º–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
- ‚úÖ –°–æ–∑–¥–∞–≤–∞—Ç—å –Ω–æ–≤—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –Ω–∞ –±–æ–ª–µ–µ –≥–∏–±–∫–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ
- ‚úÖ –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∞–º–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
- ‚úÖ –£–ª—É—á—à–∞—Ç—å —Ç–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–æ—Å—Ç—å –∫–æ–¥–∞

–°—Ç—Ä–∞—Ç–µ–≥–∏—è `golden_cross_v2` —Å–ª—É–∂–∏—Ç —ç—Ç–∞–ª–æ–Ω–Ω—ã–º –ø—Ä–∏–º–µ—Ä–æ–º –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤—ã—Ö V2 —Å—Ç—Ä–∞—Ç–µ–≥–∏–π.
