# Сравнение стратегий на основе сплайнов

## Обзор

В проекте реализовано 4 стратегии на основе сплайнов:

1. **Linear Alternating Spline V1** - классическая версия с линейными сплайнами
2. **Linear Spline V2** - современная версия без прогнозирования
3. **Predictive Linear Spline V2** - прогнозирующая версия с линейными сплайнами
4. **Predictive Spline V2** - прогнозирующая версия с квадратичными сплайнами

## Результаты тестирования

### Тест на TMOS (1000 свечей)

| Стратегия | Прибыль | Сделок | Финал, $ | Время |
|-----------|---------|--------|----------|-------|
| Linear Spline V2 | +19.29% | 12 | $11,929 | 242ms |
| Predictive Linear Spline V2 | +3.14% | 1 | $10,314 | 536ms |
| Buy & Hold | -0.94% | 0 | $9,906 | - |

### Тест на TMOS Big (15,323 свечи)

| Стратегия | Прибыль | Сделок | Финал, $ | Время |
|-----------|---------|--------|----------|-------|
| **Linear Spline V2** | **+1187.14%** | 215 | $128,714 | 2.7s |
| Predictive Spline V2 | +33.39% | 5 | $13,339 | 1.1s |
| **Predictive Linear Spline V2** | **+17.34%** | 10 | $11,734 | 4.0s |
| Buy & Hold | -1.26% | 0 | $9,874 | - |

## Детальное сравнение

### Linear Spline V2 (без прогнозирования)

**Характеристики:**
- ✅ Определяет развороты постфактум
- ✅ Высокая точность (работает с фактами)
- ✅ Много сделок (215 на больших данных)
- ✅ Максимальная прибыль (+1187%)
- ❌ Запаздывание при входе в позицию

**Лучше всего для:**
- Трендовых рынков с четкими разворотами
- Долгосрочной торговли
- Максимизации прибыли

**Параметры:**
```json
{
  "min_segment_length": 5,
  "max_segment_length": 30,
  "min_r2_threshold": 0.80,
  "min_slope_threshold": 0.0001
}
```

### Predictive Linear Spline V2 (прогнозирование)

**Характеристики:**
- ✅ Прогнозирует развороты заранее
- ✅ Ранний вход в позицию
- ✅ Консервативный подход (10 сделок)
- ✅ Стабильная прибыль (+17%)
- ❌ Меньше прибыли, чем у непрогнозирующей версии
- ❌ Сложнее в настройке

**Лучше всего для:**
- Рынков с предсказуемыми циклами
- Среднесрочной торговли
- Раннего входа в тренд

**Параметры:**
```json
{
  "min_segment_length": 15,
  "max_segment_length": 100,
  "prediction_horizon": 5,
  "min_r2_threshold": 0.65,
  "signal_advance": 7,
  "min_slope_threshold": 0.0005,
  "trend_exhaustion_factor": 0.85,
  "min_price_change": 0.010
}
```

### Predictive Spline V2 (квадратичные сплайны)

**Характеристики:**
- ✅ Использует квадратичную экстраполяцию
- ✅ Учитывает нелинейные движения
- ✅ Очень мало сделок (5)
- ✅ Хорошая прибыль (+33%)
- ❌ Сложная математика
- ❌ Требует больше данных

**Лучше всего для:**
- Рынков с параболическими движениями
- Долгосрочной торговли
- Минимизации количества сделок

## Ключевые метрики

### Прибыльность

```
Linear Spline V2:              ████████████████████████ +1187%
Predictive Spline V2:          ███ +33%
Predictive Linear Spline V2:   ██ +17%
Buy & Hold:                    ▌ -1%
```

### Количество сделок

```
Linear Spline V2:              ████████████████████████ 215
Predictive Linear Spline V2:   █ 10
Predictive Spline V2:          ▌ 5
Buy & Hold:                    0
```

### Средняя прибыль на сделку

```
Predictive Spline V2:          ████████ 6.68%
Linear Spline V2:              ██████ 5.52%
Predictive Linear Spline V2:   ██ 1.73%
```

### Скорость выполнения

```
Predictive Spline V2:          ████████████ 1.1s
Linear Spline V2:              ████████████████ 2.7s
Predictive Linear Spline V2:   ████████████████████ 4.0s
```

## Рекомендации по выбору

### Выбирайте Linear Spline V2, если:
- ✅ Хотите максимальную прибыль
- ✅ Готовы к большому количеству сделок
- ✅ Торгуете на трендовых рынках
- ✅ Запаздывание не критично

### Выбирайте Predictive Linear Spline V2, если:
- ✅ Хотите входить в тренд раньше
- ✅ Предпочитаете консервативный подход
- ✅ Готовы к меньшей прибыли ради раннего входа
- ✅ Рынок имеет предсказуемые циклы

### Выбирайте Predictive Spline V2, если:
- ✅ Хотите минимум сделок
- ✅ Рынок имеет параболические движения
- ✅ Нужна квадратичная экстраполяция
- ✅ Готовы к сложной настройке

## Комбинированный подход

Можно использовать несколько стратегий одновременно:

1. **Linear Spline V2** - основная стратегия для максимизации прибыли
2. **Predictive Linear Spline V2** - для раннего входа в новые тренды
3. **Predictive Spline V2** - для подтверждения сильных трендов

## Улучшения в Predictive Linear Spline V2

После оптимизации механизма подбора параметров:

**Было:**
- Прибыль: -23.18%
- Сделок: 55
- Проблема: Слишком агрессивная генерация сигналов

**Стало:**
- Прибыль: +17.34%
- Сделок: 10
- Решение: Консервативные параметры и строгие фильтры

### Ключевые улучшения:

1. **Более строгие пороги R²**: 0.65-0.80 вместо 0.50-0.70
2. **Больше минимальная длина тренда**: 8-20 вместо 5-12
3. **Выше минимальное изменение цены**: 0.5%-1.5% вместо 0.2%-0.5%
4. **Адаптивный порог уверенности**: 0.40 для больших данных
5. **Увеличенное расстояние между сигналами**: 3x вместо 1x
6. **Улучшенная формула уверенности**: Штрафы за ранние и ускоряющиеся тренды

## Заключение

Каждая стратегия имеет свои сильные стороны:

- **Linear Spline V2** - лучшая для максимизации прибыли
- **Predictive Linear Spline V2** - лучшая для раннего входа
- **Predictive Spline V2** - лучшая для минимизации сделок

Выбор зависит от ваших целей, стиля торговли и характеристик рынка.
