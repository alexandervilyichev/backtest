# Предсказание Golden Cross / Death Cross

## Описание

Добавлена возможность предсказывать ближайшее пересечение скользящих средних (Golden Cross или Death Cross) для стратегии Golden Cross V2.

## Реализация

### Метод PredictNextSignal

Метод анализирует текущее состояние быстрой и медленной EMA и предсказывает точку их пересечения.

```go
func (sg *GoldenCrossSignalGenerator) PredictNextSignal(
    candles []internal.Candle,
    config internal.StrategyConfigV2,
) *internal.FutureSignal
```

### Алгоритм

1. **Расчет EMA**
   - Вычисляет быструю EMA (Fast Period)
   - Вычисляет медленную EMA (Slow Period)

2. **Анализ текущего состояния**
   - Определяет, какая линия выше
   - Вычисляет расстояние между линиями

3. **Расчет скоростей**
   - Вычисляет скорость изменения Fast EMA
   - Вычисляет скорость изменения Slow EMA
   - Определяет относительную скорость (Fast - Slow)

4. **Проверка возможности пересечения**
   - Если Fast выше и растет быстрее → расхождение вверх → пересечение невозможно
   - Если Fast ниже и падает быстрее → расхождение вниз → пересечение невозможно
   - Если скорость сближения слишком мала → пересечение слишком далеко
   - Если пересечение дальше SlowPeriod свечей → горизонт слишком далек

5. **Предсказание пересечения**
   - Вычисляет количество свечей до пересечения: `distance / relativeVelocity`
   - Экстраполирует цену в точке пересечения
   - Определяет тип сигнала:
     - **Golden Cross (BUY)** - Fast пересекает Slow снизу вверх
     - **Death Cross (SELL)** - Fast пересекает Slow сверху вниз

6. **Оценка уверенности**
   - Базовая уверенность от скорости сближения (чем быстрее, тем лучше)
   - Бонус за близость пересечения (чем ближе, тем надежнее)
   - Бонус за стабильность скорости (сравнение с предыдущим периодом)

## Использование

### Пример кода

```go
generator := trend.NewGoldenCrossSignalGenerator()

config := &trend.GoldenCrossConfig{
    FastPeriod: 50,
    SlowPeriod: 200,
}

futureSignal := generator.PredictNextSignal(candles, config)

if futureSignal != nil {
    fmt.Printf("Тип: %s\n", futureSignal.SignalType)
    fmt.Printf("Дата: %s\n", time.Unix(futureSignal.Date, 0))
    fmt.Printf("Цена: %.4f\n", futureSignal.Price)
    fmt.Printf("Уверенность: %.2f%%\n", futureSignal.Confidence*100)
}
```

### Готовый пример

```bash
go build -o predict_golden_cross examples/predict_golden_cross_example.go
./predict_golden_cross tmos_big.json
```

## Параметры конфигурации

### Популярные комбинации периодов

| Fast | Slow | Применение |
|------|------|------------|
| 12   | 26   | Краткосрочная торговля (MACD) |
| 20   | 50   | Среднесрочная торговля |
| 50   | 200  | Долгосрочная торговля (классический Golden Cross) |

### Выбор периодов

- **Короткие периоды (12/26)** - больше сигналов, но больше ложных
- **Средние периоды (20/50)** - баланс между частотой и надежностью
- **Длинные периоды (50/200)** - редкие, но надежные сигналы

## Когда предсказание невозможно

Метод возвращает `nil` в следующих случаях:

1. **Недостаточно данных**
   - Меньше чем `SlowPeriod * 2` свечей

2. **Линии расходятся**
   - Fast выше Slow и растет быстрее (расхождение вверх)
   - Fast ниже Slow и падает быстрее (расхождение вниз)

3. **Скорость сближения слишком мала**
   - `|relativeVelocity| < 0.0001`
   - Пересечение произойдет в очень далеком будущем

4. **Пересечение за горизонтом**
   - Дальше чем `SlowPeriod` свечей

## Интерпретация результатов

### Уверенность

- **>= 70%** - Высокая уверенность, надежный сигнал
- **50-70%** - Средняя уверенность, рекомендуется подтверждение
- **< 50%** - Низкая уверенность, используйте с осторожностью

### Типы сигналов

**Golden Cross (BUY)**
- Быстрая EMA пересекает медленную снизу вверх
- Бычий сигнал
- Указывает на начало восходящего тренда

**Death Cross (SELL)**
- Быстрая EMA пересекает медленную сверху вниз
- Медвежий сигнал
- Указывает на начало нисходящего тренда

## Ограничения

1. **Линейная экстраполяция**
   - Предполагает, что скорости EMA останутся постоянными
   - Не учитывает возможные изменения тренда

2. **Не учитывает внешние факторы**
   - Новости, события, фундаментальные изменения
   - Резкие изменения волатильности

3. **Работает лучше на трендовых рынках**
   - На боковых рынках может давать ложные сигналы
   - Требует подтверждения другими индикаторами

4. **Запаздывание**
   - EMA - запаздывающий индикатор
   - Сигналы могут приходить с опозданием

## Рекомендации

1. **Используйте подтверждение**
   - Объем торгов
   - Другие индикаторы (RSI, MACD)
   - Уровни поддержки/сопротивления

2. **Учитывайте таймфрейм**
   - Долгосрочные периоды (50/200) - для позиционной торговли
   - Краткосрочные периоды (12/26) - для активной торговли

3. **Проверяйте уверенность**
   - Не торгуйте по сигналам с низкой уверенностью
   - Ждите подтверждения при средней уверенности

4. **Следите за контекстом рынка**
   - На трендовых рынках стратегия работает лучше
   - На боковых рынках используйте с осторожностью
